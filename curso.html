<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Curso - ConectaFisio360</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
body{
    margin:0;
    font-family:'Poppins', sans-serif;
    background:linear-gradient(135deg,#0f172a,#0b1120);
    color:white;
}

header{
    display:flex;
    justify-content:space-between;
    padding:20px 40px;
    background:#0b1120;
}

header a{
    color:#38bdf8;
    text-decoration:none;
    margin-right:20px;
}

.container{
    padding:40px;
    max-width:900px;
    margin:auto;
}

iframe{
    width:100%;
    height:500px;
    border-radius:15px;
    margin-top:20px;
    border:0;
}

.bloqueado{
    margin-top:30px;
    padding:20px;
    background:#1e293b;
    border-radius:15px;
}
</style>
</head>
<body>

<header>
    <div>ConectaFisio360</div>
    <div>
        <a href="cursos.html">üìö Voltar</a>
        <a href="index.html">üè† Home</a>
    </div>
</header>

<div class="container">
    <h1 id="titulo">Carregando...</h1>
    <p id="descricao"></p>
    <div id="conteudo"></div>
</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBceFT9nmk1XfVbYZEcZ3yUY1pstUblD3E",
  authDomain: "conectafisio-web.firebaseapp.com",
  databaseURL: "https://conectafisio-web-default-rtdb.firebaseio.com",
  projectId: "conectafisio-web",
  storageBucket: "conectafisio-web.firebasestorage.app",
  messagingSenderId: "816967061116",
  appId: "1:816967061116:web:0c716703027427827fc3f9"
};

const app = initializeApp(firebaseConfig);
const database = getDatabase(app);

const userRole = localStorage.getItem('simulacao_plano') || 'normal';

const params = new URLSearchParams(window.location.search);
const cursoId = params.get("id");

const titulo = document.getElementById("titulo");
const descricao = document.getElementById("descricao");
const conteudo = document.getElementById("conteudo");

if(!cursoId){
    titulo.innerText = "Curso n√£o encontrado";
}else{
    const cursoRef = ref(database, "cursos/" + cursoId);
    get(cursoRef).then((snapshot)=>{
        if(snapshot.exists()){
            const curso = snapshot.val();
            titulo.innerText = curso.titulo;
            descricao.innerText = curso.descricao;

            if(curso.tipo === "premium" && userRole !== "premium"){
                conteudo.innerHTML = `
                    <div class="bloqueado">
                        üîí Este curso √© Premium.<br><br>
                        Fa√ßa upgrade para acessar.
                    </div>
                `;
            }else{
                conteudo.innerHTML = `
                    <iframe src="${curso.link}" allowfullscreen></iframe>
                `;
            }
        }else{
            titulo.innerText = "Curso n√£o encontrado";
        }
    });
}

</script>

</body>
</html>
